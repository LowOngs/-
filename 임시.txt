<!-- ▼ Footer Partners (v12r2): OFF=회색/비클릭, ON+URL없음=컬러/비클릭, ON+URL있음=컬러/클릭 -->
<style>
  .partner-wrap{
    --btnSize:74px; --arrowSize:88px; --gap:12px;
  }
  .partner-wrap .arrow{
    width:var(--arrowSize);height:var(--arrowSize);
    border:none;border-radius:9999px;background:#555;color:#fff;
    cursor:pointer;display:inline-flex;align-items:center;justify-content:center;
    font-size:42px;box-shadow:0 3px 6px rgba(0,0,0,.25);
  }
  .partner-wrap .strip{
    flex:1 1 auto;display:flex;gap:var(--gap);
    overflow-x:auto;white-space:nowrap;-webkit-overflow-scrolling:touch;
    scroll-snap-type:x mandatory;scroll-behavior:smooth;
    padding:12px 0;border-top:1px solid #e5e7eb;border-bottom:1px solid #e5e7eb;
  }
  .partner-wrap .card{
    flex:0 0 auto;scroll-snap-align:center;
    width:var(--btnSize);height:var(--btnSize);
    border:1px solid #e5e7eb;border-radius:12px;overflow:hidden;padding:0;background:none;
    display:inline-flex;align-items:center;justify-content:center;
  }
  .partner-wrap .card img{
    width:100%;height:100%;object-fit:cover;border-radius:12px;display:block;
    transition:transform .2s ease;
  }
  /* 로고 작았던 3개 확대 유지 */
  .partner-wrap .card img[src*="amazon_india"]{ transform:scale(1.34); }
  .partner-wrap .card img[src*="allegro"]{       transform:scale(1.32); }
  .partner-wrap .card img[src*="aliexpress"]{    transform:scale(1.32); }

  /* 기본: 회색 + 비클릭 */
  .partner-wrap .partner-btn.state-off,
  .partner-wrap .partner-btn.state-on-noclick {
    filter: grayscale(1) brightness(.85) opacity(.55) !important;
    cursor: default !important;
  }
  .partner-wrap .partner-btn.state-off img,
  .partner-wrap .partner-btn.state-on-noclick img{
    filter: grayscale(1) brightness(.9) opacity(.75) !important;
  }

  /* ON 컬러(클릭 가능/불가 공통) */
  .partner-wrap .partner-btn.state-on,
  .partner-wrap .partner-btn.state-on-noclick{
    filter:none !important;
  }
</style>

<div class="partner-wrap" style="display:flex;align-items:center;justify-content:center;gap:14px;max-width:100%;margin:14px 0;">
  <button type="button" class="arrow" aria-label="Scroll left"
          onclick="this.nextElementSibling.scrollBy({left:-420,behavior:'smooth'})">‹</button>

  <div class="strip">
    <a class="card partner-btn" data-pid="amazon" aria-label="Amazon">
      <img src="https://github.com/LowOngs/-/blob/google-blog/Sys_blog_imgs/btn_square_amazon.png?raw=1" alt="Amazon" />
    </a>
    <a class="card partner-btn" data-pid="ebay" aria-label="eBay">
      <img src="https://github.com/LowOngs/-/blob/google-blog/Sys_blog_imgs/btn_square_ebay.png?raw=1" alt="eBay" />
    </a>
    <a class="card partner-btn" data-pid="target" aria-label="Target">
      <img src="https://github.com/LowOngs/-/blob/google-blog/Sys_blog_imgs/btn_square_target.png?raw=1" alt="Target" />
    </a>
    <a class="card partner-btn" data-pid="mercadolibre" aria-label="Mercado Libre">
      <img src="https://github.com/LowOngs/-/blob/google-blog/Sys_blog_imgs/btn_square_mercadolibre.png?raw=1" alt="Mercado Libre" />
    </a>
    <a class="card partner-btn" data-pid="flipkart" aria-label="Flipkart">
      <img src="https://github.com/LowOngs/-/blob/google-blog/Sys_blog_imgs/btn_square_flipkart.png?raw=1" alt="Flipkart" />
    </a>
    <a class="card partner-btn" data-pid="amazon_in" aria-label="Amazon India">
      <img src="https://github.com/LowOngs/-/blob/google-blog/Sys_blog_imgs/btn_square_amazon_india.png?raw=1" alt="Amazon India" />
    </a>
    <a class="card partner-btn" data-pid="shopee" aria-label="Shopee">
      <img src="https://github.com/LowOngs/-/blob/google-blog/Sys_blog_imgs/btn_square_shopee.png?raw=1" alt="Shopee" />
    </a>
    <a class="card partner-btn" data-pid="lazada" aria-label="Lazada">
      <img src="https://github.com/LowOngs/-/blob/google-blog/Sys_blog_imgs/btn_square_lazada.png?raw=1" alt="Lazada" />
    </a>
    <a class="card partner-btn" data-pid="aliexpress" aria-label="AliExpress">
      <img src="https://github.com/LowOngs/-/blob/google-blog/Sys_blog_imgs/btn_square_aliexpress.png?raw=1" alt="AliExpress" />
    </a>
    <a class="card partner-btn" data-pid="otto" aria-label="Otto">
      <img src="https://github.com/LowOngs/-/blob/google-blog/Sys_blog_imgs/btn_square_otto.png?raw=1" alt="Otto" />
    </a>
    <a class="card partner-btn" data-pid="zalando" aria-label="Zalando">
      <img src="https://github.com/LowOngs/-/blob/google-blog/Sys_blog_imgs/btn_square_zalando.png?raw=1" alt="Zalando" />
    </a>
    <a class="card partner-btn" data-pid="allegro" aria-label="Allegro">
      <img src="https://github.com/LowOngs/-/blob/google-blog/Sys_blog_imgs/btn_square_allegro.png?raw=1" alt="Allegro" />
    </a>
  </div>

  <button type="button" class="arrow" aria-label="Scroll right"
          onclick="this.previousElementSibling.scrollBy({left:420,behavior:'smooth'})">›</button>
</div>

<p style="text-align:center;margin:.6rem 0 0 0;font-size:.8rem;color:#ddd;white-space:normal;">
  Affiliate use is free. For certain affiliate programs, the operator receives a commission from the affiliate.
</p>

<script>
(function(){
  /* ⬇ 쿼리 없는 exec 주소 */
  const EXEC_BASE = 'https://script.google.com/macros/s/AKfycbxVHS_QoctY0cxMq9eHZGxlwT7obwzajAnvV22WDHJ-F6kgJDazRK6crq6mgLnjGeBuIw/exec';

  const withQS = (base, params) => {
    const u = new URL(base);
    Object.entries(params).forEach(([k,v]) => u.searchParams.set(k, v));
    return u.toString();
  };

  window.addEventListener('load', init, {once:true});

  function paintState(el, st){
    // st: { on:boolean, clickable:boolean, href:string }
    // 1) OFF → 회색·비클릭
    if (!st || !st.on){
      el.classList.remove('state-on','state-on-noclick');
      el.classList.add('state-off');
      el.removeAttribute('href'); el.removeAttribute('target'); el.removeAttribute('rel');
      el.style.pointerEvents = 'none';
      return;
    }
    // 2) ON + URL 없음 → 컬러지만 비클릭
    if (st.on && !st.clickable){
      el.classList.remove('state-off','state-on');
      el.classList.add('state-on-noclick');
      el.removeAttribute('href'); el.removeAttribute('target'); el.removeAttribute('rel');
      el.style.pointerEvents = 'none';
      return;
    }
    // 3) ON + URL 있음 → 컬러 + 클릭 가능 (집계 경유)
    el.classList.remove('state-off','state-on-noclick');
    el.classList.add('state-on');
    el.href   = withQS(EXEC_BASE, {cmd:'go', pid: el.getAttribute('data-pid'), src:'footer'});
    el.target = '_blank';
    el.rel    = 'nofollow noopener';
    el.style.pointerEvents = '';
  }

  function init(){
    const els = document.querySelectorAll('.partner-btn[data-pid]');
    if (!els.length) return;

    // 초기 상태: 모두 OFF로 칠해 두기
    els.forEach(el=>{
      el.classList.add('state-off');
      el.removeAttribute('href'); el.removeAttribute('target'); el.removeAttribute('rel');
      el.style.pointerEvents = 'none';
    });

    // 보호: OFF/NoLink 상태에서는 클릭 무시
    document.addEventListener('click', function(e){
      const a = e.target.closest('.partner-btn');
      if (!a) return;
      if (a.classList.contains('state-off') || a.classList.contains('state-on-noclick')){
        e.preventDefault(); e.stopPropagation();
      }
    }, true);

    // 활성맵 불러오기
    fetch(withQS(EXEC_BASE, {cmd:'map'}), {cache:'no-store'})
      .then(r => { if(!r.ok) throw new Error('map http '+r.status); return r.json(); })
      .then(map => {
        els.forEach(el=>{
          const pid = el.getAttribute('data-pid');
          const st  = (map && map[pid]) ? map[pid] : {on:false, clickable:false, href:''};
          paintState(el, st);
        });
      })
      .catch(err=>{
        console.warn('[partners] map fetch failed:', err);
        // 실패 시 초기 OFF 상태 유지
      });
  }
})();
</script>
