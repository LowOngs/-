<!-- 📌Total Pageviews – Right-anchored Flip Plates + Divider + Optimistic +1 -->
<div id="statsBoard" style="margin:0;padding:0;text-align:left;">
  <!-- 상단: 월간(30일) -->
  <div id="monthly_wrap" aria-label="Last 30 days" style="margin:0;padding:0;text-align:right;">
    <span
      style="display:inline-block;min-width:20px;margin-left:6px;padding:6px 8px;background:#000;
             color:#22bb33;font-weight:700;font-size:22px;border-radius:3px;
             box-shadow:0 2px 0 rgba(0,0,0,.35), inset 0 -2px 0 rgba(255,255,255,.08);
             text-align:center;letter-spacing:.5px;white-space:nowrap;user-select:none;">0</span>
  </div>

  <!-- 🌙 반투명 구분선 -->
  <hr style="border:none;height:1px;background:rgba(255,255,255,0.2);margin:4px 0;">

  <!-- 하단: 총계 -->
  <div id="total_wrap" aria-label="All time total" style="margin:0;padding:0;text-align:right;">
    <span
      style="display:inline-block;min-width:20px;margin-left:6px;padding:6px 8px;background:#000;
             color:#ffffff;font-weight:700;font-size:22px;border-radius:3px;
             box-shadow:0 2px 0 rgba(0,0,0,.35), inset 0 -2px 0 rgba(255,255,255,.08);
             text-align:center;letter-spacing:.5px;white-space:nowrap;user-select:none;">0</span>
  </div>
</div>

<script>
(function(){
  // ✅ 옹스님 Web App URL
  var API_URL = 'https://script.google.com/macros/s/AKfycbw0goSuOmV0P6N7sl5Wn8yrcA1Cz9ia58HdzjSYoIQXv7lApHc8SYa4Dkuf7VKo9VIX/exec';
  const OPTIMISTIC = true; // 화면용 +1 적용 여부

  function tokensUS(n){
    n = (isFinite(n) && n>0) ? Math.floor(n) : 0;
    if(n < 1e6){ return addCommas(String(n)).split(''); }
    if(n < 1e9){
      var M=Math.floor(n/1e6),K=Math.floor((n%1e6)/1e3);
      var out=String(M)+'M'+(K>0?' '+String(K)+'K':''); return out.split('');
    }
    var B=Math.floor(n/1e9),M2=Math.floor((n%1e9)/1e6);
    var out2=String(B)+'B'+(M2>0?' '+String(M2)+'M':''); return out2.split('');
  }
  function addCommas(s){ return s.replace(/\B(?=(\d{3})+(?!\d))/g, ','); }

  function makePlate(ch,isMonthly){
    var span=document.createElement('span');
    var base='display:inline-block;min-width:20px;margin-left:6px;padding:6px 8px;background:#000;'+
             'font-weight:700;font-size:22px;border-radius:3px;'+
             'box-shadow:0 2px 0 rgba(0,0,0,.35), inset 0 -2px 0 rgba(255,255,255,.08);'+
             'text-align:center;letter-spacing:.5px;white-space:nowrap;user-select:none;';
    var color=isMonthly?'#22bb33':'#ffffff';
    if(ch===','){base=base.replace('min-width:20px','min-width:12px').replace('padding:6px 8px','padding:6px 4px');}
    if(ch==='K'||ch==='M'||ch==='B'){base=base.replace('background:#000','background:#111');}
    if(ch===' '){var sp=document.createElement('span');sp.setAttribute('style','display:inline-block;width:4px;');return sp;}
    span.setAttribute('style',base+'color:'+color+';'); span.textContent=ch; return span;
  }

  function renderRow(wrapperId,val,isMonthly){
    var wrap=document.getElementById(wrapperId);
    if(!wrap)return;
    while(wrap.firstChild){wrap.removeChild(wrap.firstChild);}
    var tks=tokensUS(val); if(!tks||!tks.length){tks=['0'];}
    for(var i=0;i<tks.length;i++){wrap.appendChild(makePlate(tks[i],isMonthly));}
  }

  try{
    fetch(API_URL,{cache:'no-store'})
      .then(r=>r.json())
      .then(data=>{
        // ✅ 월간(30D) 없으면 전체(total)로 대체
        var monthly = (data && isFinite(data.monthly) && data.monthly>0)
                      ? Math.floor(data.monthly)
                      : (isFinite(data.total) ? Math.floor(data.total) : 0);
        var total   = (data && (isFinite(data.total)?Math.floor(data.total)
                        :isFinite(data.yearly)?Math.floor(data.yearly)
                        :isFinite(data.all)?Math.floor(data.all):0))||0;

        // ✅ 시각적 +1 처리 (탭당 1회)
        if (OPTIMISTIC) {
          const bumped = sessionStorage.getItem('pv_bumped') === '1';
          if (!bumped) {
            monthly += 1; total += 1;
            sessionStorage.setItem('pv_bumped','1');
          }
        }

        renderRow('monthly_wrap',monthly,true);
        renderRow('total_wrap',total,false);
      })
      .catch(()=>{});
  }catch(e){}
})();
</script>
