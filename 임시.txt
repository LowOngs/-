<!-- Saved Posts (client-side, localStorage) — compact layout -->
<style>
  .sp-wrap{font:14px/1.5 system-ui,Segoe UI,Helvetica,Arial;color:#111}
  .sp-field{position:relative;margin:8px 0}
  .sp-input{width:100%;padding:10px 12px;border:1px solid #e5e7eb;border-radius:8px;box-sizing:border-box}
  .sp-count{position:absolute;right:10px;top:50%;transform:translateY(-50%);
            font-size:12px;color:#6b7280;background:#f3f4f6;border:1px solid #e5e7eb;border-radius:999px;
            padding:2px 6px;pointer-events:none}
  .sp-actions{display:flex;gap:8px;margin-top:8px}
  .sp-btn{appearance:none;border:0;border-radius:8px;padding:10px 12px;font-weight:700;cursor:pointer;flex:1}
  .sp-btn.save{background:#2563eb;color:#fff}
  .sp-btn.clear{background:#ef4444;color:#fff}
  .sp-tip{margin:6px 0 8px 0;color:#6b7280;font-size:12px}
  .sp-err{color:#ef4444;font-size:12px;margin:4px 0 0 0;display:none}
  .sp-list{display:flex;flex-direction:column;gap:6px;margin:10px 0 0}
  .sp-item{display:flex;align-items:center;justify-content:space-between;
           border:1px solid #e5e7eb;border-radius:8px;padding:8px 10px;background:#fff}
  .sp-id{font-weight:700}
  .sp-del{background:none;border:0;color:#ef4444;font-weight:800;cursor:pointer;font-size:16px;line-height:1}
  .sp-del:focus{outline:2px solid #ef4444;outline-offset:2px}
</style>

<div class="sp-wrap" id="spRoot">
  <!-- 제목은 가젯 타이틀에서 별도 설정 -->
  <div class="sp-field">
    <!-- placeholder는 영어, 내부 주석은 한글 -->
    <input id="spInput" class="sp-input" type="text" maxlength="30"
           placeholder="Enter page id (e.g., page123)" aria-label="Enter page id">
    <span id="spCount" class="sp-count">0/10</span>
  </div>

  <div class="sp-actions">
    <button class="sp-btn save"  id="spSaveBtn"  type="button">Save</button>
    <button class="sp-btn clear" id="spClearBtn" type="button">Clear All</button>
  </div>

  <div class="sp-tip" id="spTip">Tip: Enter only the page id (e.g., page123). Max 10 saved.</div>
  <div class="sp-err" id="spErr"></div>
  <div class="sp-list" id="spList" role="list"></div>
</div>

<script>
(function(){
  'use strict';
  // ===== 설정 =====
  var LS_KEY = 'ongs_saved_posts';   // 로컬스토리지 키
  var ID_RE  = /^page\d+$/i;         // page+숫자 패턴

  // ===== 엘리먼트 =====
  var $ = function(s){ return document.querySelector(s); };
  var inp     = $('#spInput');
  var errBox  = $('#spErr');
  var listEl  = $('#spList');
  var saveBtn = $('#spSaveBtn');
  var clrBtn  = $('#spClearBtn');
  var countEl = $('#spCount');

  // ===== 저장/불러오기 =====
  function loadList(){
    try{
      var raw = localStorage.getItem(LS_KEY);
      var arr = raw ? JSON.parse(raw) : [];
      return Array.isArray(arr) ? arr : [];
    }catch(e){ return []; }
  }
  function saveList(arr){
    try{ localStorage.setItem(LS_KEY, JSON.stringify(arr)); }catch(e){}
  }

  // ===== 렌더 & 카운터 =====
  function updateCount(){
    var n = loadList().length;
    countEl.textContent = n + '/10';
  }
  function render(){
    var items = loadList();
    listEl.innerHTML = '';
    items.forEach(function(id, idx){
      var row = document.createElement('div');
      row.className = 'sp-item';
      row.setAttribute('role','listitem');

      var left = document.createElement('div');
      left.className = 'sp-id';
      left.textContent = id;

      var del = document.createElement('button');
      del.className = 'sp-del';
      del.type = 'button';
      del.setAttribute('aria-label','Delete '+id);
      del.textContent = '×';
      del.addEventListener('click', function(){ removeAt(idx); });

      row.appendChild(left);
      row.appendChild(del);
      listEl.appendChild(row);
    });
    updateCount();
  }

  // ===== 에러 표시 =====
  function showError(msg){
    errBox.textContent = msg || '';
    errBox.style.display = msg ? 'block' : 'none';
  }

  // ===== 추가/삭제 로직 =====
  function addId(id){
    var v = String(id || '').trim();
    if (!ID_RE.test(v)){
      showError('Use format: page123 (letters "page" + digits).');
      return;
    }
    var list = loadList();
    // 중복이면 앞으로 이동
    var lower = v.toLowerCase();
    var pos = list.findIndex(function(x){ return String(x).toLowerCase() === lower; });
    if (pos >= 0){
      list.splice(pos,1);
      list.unshift(v);
      saveList(list);
      showError('');
      inp.value = '';
      render();
      return;
    }
    // 새 추가 — 최대 10 제한
    if (list.length >= 10){
      showError('You can save up to 10 items. Delete some or clear all first.');
      return;
    }
    list.unshift(v);
    saveList(list);
    showError('');
    inp.value = '';
    render();
  }
  function removeAt(index){
    var list = loadList();
    if (index<0 || index>=list.length) return;
    list.splice(index,1);
    saveList(list);
    render();
  }
  function clearAll(){
    saveList([]);
    render();
  }

  // ===== 이벤트 =====
  saveBtn.addEventListener('click', function(){ addId(inp.value); });
  inp.addEventListener('keydown', function(e){ if (e.key==='Enter') addId(inp.value); });
  clrBtn.addEventListener('click', function(){
    if (confirm('Clear all saved items?')) clearAll();
  });
  inp.addEventListener('input', function(){ showError(''); });

  // 초기 렌더
  render();
})();
</script>
