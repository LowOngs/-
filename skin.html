<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>옹달샘 지식 아카이브 · Where Knowledge and Commerce Coexist</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <!-- 파비콘/아이콘 -->
  <link rel="icon" href="favicon_rabbit.png?v=122">
  <link rel="apple-touch-icon" href="icon-192.png?v=122" />
  <!-- 스타일 -->
  <link rel="stylesheet" href="style.css?v=122" />
  <!-- 티스토리 변수 주입을 위한 메타 (필수 아님 / 가이드용) -->
  <meta name="theme-color" content="#111" />
</head>
<body class="pc2"> <!-- pc1/pc2 전환: body class 로 제어 -->

  <!-- 접근성 스킵링크 -->
  <a class="skip" href="#main">본문으로</a>
  <a class="skip" href="#sidebar">사이드바로</a>

  <!-- 헤더 : PC2 고정, PC1 비고정(스크롤) -->
  <header id="site-header" class="header">
    <div class="header-inner">
      <!-- PC2 대문 이미지(클릭=홈), 호버=말풍선 -->
      <a class="hero-link" href="/" title="블로그 홈으로 이동">
        <img class="hero-image" src="header_logo_pc2_main.png?v=122" alt="블로그 대문" />
        <span class="hero-tooltip">블로그 홈 이동</span>
      </a>

      <!-- 블로그 타이틀/설명 (PC1에서는 타이틀 앞에 토끼 아이콘) -->
      <div class="brand">
        <img class="brand-icon pc1-only" src="icon_pc1_sidebar_rabbit.png?v=122" alt="" aria-hidden="true" />
        <h1 class="brand-name">옹달샘 지식 아카이브</h1>
        <p class="brand-desc">지식과 커머스가 공존하는 곳</p>
      </div>

      <!-- 가입/관리 버튼: 로그인 운영자면 ‘관리’ 노출, 아니면 ‘가입’ -->
      <div class="header-cta">
        <!-- 운영자 모드일 때 -->
        <a class="btn admin-only" href="/admin" data-role="admin">관리</a>
        <!-- 비로그인/일반일 때 -->
        <a class="btn guest-only" href="/signup" data-role="guest">가입</a>
      </div>

      <!-- 상단 검색 -->
      <form class="search" action="/search" method="get" role="search">
        <input type="search" name="q" placeholder="검색…" />
        <button type="submit" class="btn">검색</button>
      </form>
    </div>
  </header>

  <!-- 본문/사이드/푸터 3단 스켈레톤 -->
  <div id="layout">
    <!-- 사이드바 (pc2 독립 스크롤) -->
    <aside id="sidebar" class="sidebar">
      <!-- 번역 위젯(공용) -->
      <div class="card translate-widget">
        <div id="translate-orb" title="번역">
          <img src="icon_translate_rabbit.png?v=122" alt="Translate" />
        </div>
      </div>

      <!-- 공지 -->
      <section class="card notice">
        <h2>공지사항</h2>
        <div class="notice-ticker" tabindex="0" aria-label="공지 텍스트 스크롤">
          공지 내용 스크롤 출력… <button class="notice-confirm admin-only" type="button">확인</button>
        </div>
      </section>

      <hr class="divider" aria-hidden="true"/>

      <!-- 카테고리 (아코디언/호버 후광) -->
      <section class="card categories">
        <h2>
          <img class="cat-icon pc2-only" src="icon_pc2_category_rabbit.png?v=122" alt="" aria-hidden="true" />
          카테고리
        </h2>

        <ul class="cat-root">
          <li class="cat-item">
            <button class="cat-head" type="button">
              <img src="icon_pc1_category_rabbit.png?v=122" alt="" aria-hidden="true" />
              IT/디지털
            </button>
            <ul class="cat-sub">
              <li><a href="/category/it-news">최신 IT뉴스</a></li>
              <li><a href="/category/ai-future">AI &amp; 미래기술</a></li>
              <li><a href="/category/app-review">앱 &amp; 제품 리뷰</a></li>
            </ul>
          </li>

          <li class="cat-item">
            <button class="cat-head" type="button">
              <img src="icon_pc1_category_rabbit.png?v=122" alt="" aria-hidden="true" />
              시사/트렌드
            </button>
            <ul class="cat-sub">
              <li><a href="/category/social">사회정치</a></li>
              <li><a href="/category/global-issue">글로벌이슈</a></li>
              <li><a href="/category/life-trend">라이프 트렌드</a></li>
            </ul>
          </li>
        </ul>

        <!-- 아코디언 확장 대비 3줄 공간 확보 -->
        <div class="cat-reserve-3lines" aria-hidden="true"></div>
        <hr class="divider" aria-hidden="true"/>
      </section>

      <!-- 특가 정보(슬롯 3) + Deal/D 마커 -->
      <section class="card deals">
        <h2>
          <span class="gift-left" aria-hidden="true">🎁</span>
          특가 안내
          <span class="gift-right" aria-hidden="true">🎁</span>
        </h2>
        <ol class="deal-slots">
          <li class="slot slot-1">쿠팡 특가 상품</li>
          <li class="slot slot-2">아마존 특가 상품</li>
          <li class="slot slot-3">무신사 특가 상품</li>
        </ol>
      </section>

      <hr class="divider" aria-hidden="true"/>

      <!-- 애드센스 #1 -->
      <section class="card ads">
        <h2 class="sr-only">Ads Google</h2>
        <div class="adsense-snippet" data-slot="sidebar-1"></div>
      </section>

      <!-- 애드센스 #2 -->
      <section class="card ads">
        <h2 class="sr-only">Ads Google</h2>
        <div class="adsense-snippet" data-slot="sidebar-2"></div>
      </section>

      <!-- 방문자 통계(일/월 2층) -->
      <section class="card visits">
        <h2>Visitor</h2>
        <div class="visit-row">
          <span>Daily:</span> <strong id="visit-daily">0</strong>
        </div>
        <div class="visit-row">
          <span>Monthly:</span> <strong id="visit-monthly" class="visit-monthly">0</strong>
        </div>
      </section>

      <hr class="divider" aria-hidden="true"/>

      <!-- 운영자 구역 (로그인시에만) -->
      <section class="card admin-only">
        <h2>❀ 제휴 방문 집계 ❀</h2>
        <ul class="aff-visits">
          <li>coupang <b>0</b></li>
          <li>gmarket <b>0</b></li>
          <li>11st <b>0</b></li>
          <li>musinsa <b>0</b></li>
          <li>amazon <b>0</b></li>
          <li>ebay <b>0</b></li>
          <li>aliexpress <b>0</b></li>
          <li>otto <b>0</b></li>
          <li>allegro <b>0</b></li>
          <li>lazada <b>0</b></li>
          <li>shopee <b>0</b></li>
          <li>auction <b>0</b></li>
        </ul>

        <hr class="divider" aria-hidden="true"/>
        <h3>❀ 파트너스 코드 관리 ❀</h3>

        <!-- 메인 카테고리 12개(아코디언) : 각 내부에 ID/딥링크/API 입력창 -->
        <ul class="partners-admin">
          <!-- 예시 하나(12개 동일 구조) -->
          <li class="p-item">
            <button class="p-head" type="button">1. Coupang <span class="p-apply">적용</span></button>
            <div class="p-body">
              <label>Partner ID <input type="text" data-key="coupang_id"/></label>
              <label>DeepLink/Tracking <input type="url" data-key="coupang_url"/></label>
              <label>API Key <input type="text" data-key="coupang_api"/></label>
            </div>
          </li>
          <!-- …2~12 반복… -->
        </ul>
      </section>
    </aside>

    <!-- 메인 -->
    <main id="main" class="main">
      <!-- 0글 방지용 스켈레톤(게시글 없을 때도 뼈대 유지) -->
      <article class="post-skeleton">
        <h2 class="post-title">게시된 글이 없습니다</h2>
        <p class="post-explain">첫 글 작성 전이라도 레이아웃은 유지됩니다.</p>
      </article>

      <!-- 본문 하단 내비(PC2): 스크롤 감지 시 라인화살표 + 텍스트 -->
      <nav class="reading-nav pc2-only" aria-label="글 이동">
        <a class="nav-prev" href="/category/related-prev" data-role="prev">
          <span class="arrow-line"></span><span class="nav-text">이전글</span>
        </a>
        <a class="nav-next" href="/category/related-next" data-role="next">
          <span class="arrow-line"></span><span class="nav-text">최신글</span>
        </a>
      </nav>
    </main>
  </div>

  <!-- 고정 푸터 -->
  <footer id="site-footer" class="footer">
    <!-- PC2: 2.5:1 풀 네이밍 버튼 12개 한 줄, 줄바꿈 없음 -->
    <div class="partners pc2-only" role="list" aria-label="파트너 바로가기">
      <a role="listitem" class="partner" data-key="coupang" href="#" rel="sponsored">
        <img src="btn_pc2_01_coupang.png?v=122" alt="Coupang" />
      </a>
      <a role="listitem" class="partner" data-key="gmarket" href="#" rel="sponsored">
        <img src="btn_pc2_02_gmarket.png?v=122" alt="Gmarket" />
      </a>
      <a role="listitem" class="partner" data-key="11st" href="#" rel="sponsored">
        <img src="btn_pc2_03_11st.png?v=122" alt="11st" />
      </a>
      <a role="listitem" class="partner" data-key="musinsa" href="#" rel="sponsored">
        <img src="btn_pc2_04_musinsa.png?v=122" alt="MUSINSA" />
      </a>
      <a role="listitem" class="partner" data-key="amazon" href="#" rel="sponsored">
        <img src="btn_pc2_05_amazon.png?v=122" alt="Amazon" />
      </a>
      <a role="listitem" class="partner" data-key="ebay" href="#" rel="sponsored">
        <img src="btn_pc2_06_ebay.png?v=122" alt="eBay" />
      </a>
      <a role="listitem" class="partner" data-key="aliexpress" href="#" rel="sponsored">
        <img src="btn_pc2_07_aliexpress.png?v=122" alt="AliExpress" />
      </a>
      <a role="listitem" class="partner" data-key="otto" href="#" rel="sponsored">
        <img src="btn_pc2_08_otto.png?v=122" alt="OTTO" />
      </a>
      <a role="listitem" class="partner" data-key="allegro" href="#" rel="sponsored">
        <img src="btn_pc2_09_allegro.png?v=122" alt="Allegro" />
      </a>
      <a role="listitem" class="partner" data-key="lazada" href="#" rel="sponsored">
        <img src="btn_pc2_10_lazada.png?v=122" alt="Lazada" />
      </a>
      <a role="listitem" class="partner" data-key="shopee" href="#" rel="sponsored">
        <img src="btn_pc2_11_shopee.png?v=122" alt="Shopee" />
      </a>
      <a role="listitem" class="partner" data-key="auction" href="#" rel="sponsored">
        <img src="btn_pc2_12_auction.png?v=122" alt="Auction" />
      </a>
    </div>

    <!-- PC1: 반응형 고정 푸터(스크롤 다운 숨김/업 노출) + 횡스크롤 박스 -->
    <div class="partners-scroller pc1-only" aria-label="파트너 슬라이더">
      <button class="scroll-btn prev" aria-label="이전">◀</button>
      <div class="track" role="list">
        <a role="listitem" class="p" data-key="coupang" href="#"><img src="btn_pc1_01_coupang.png?v=122" alt="Coupang" /></a>
        <a role="listitem" class="p" data-key="gmarket" href="#"><img src="btn_pc1_02_gmarket.png?v=122" alt="Gmarket" /></a>
        <a role="listitem" class="p" data-key="11st" href="#"><img src="btn_pc1_03_11st.png?v=122" alt="11st" /></a>
        <a role="listitem" class="p" data-key="musinsa" href="#"><img src="btn_pc1_04_musinsa.png?v=122" alt="MUSINSA" /></a>
        <a role="listitem" class="p" data-key="amazon" href="#"><img src="btn_pc1_05_amazon.png?v=122" alt="Amazon" /></a>
        <a role="listitem" class="p" data-key="ebay" href="#"><img src="btn_pc1_06_ebay.png?v=122" alt="eBay" /></a>
        <a role="listitem" class="p" data-key="aliexpress" href="#"><img src="btn_pc1_07_aliexpress.png?v=122" alt="AliExpress" /></a>
        <a role="listitem" class="p" data-key="otto" href="#"><img src="btn_pc1_08_otto.png?v=122" alt="OTTO" /></a>
        <a role="listitem" class="p" data-key="allegro" href="#"><img src="btn_pc1_09_allegro.png?v=122" alt="Allegro" /></a>
        <a role="listitem" class="p" data-key="lazada" href="#"><img src="btn_pc1_10_lazada.png?v=122" alt="Lazada" /></a>
        <a role="listitem" class="p" data-key="shopee" href="#"><img src="btn_pc1_11_shopee.png?v=122" alt="Shopee" /></a>
        <a role="listitem" class="p" data-key="auction" href="#"><img src="btn_pc1_12_auction.png?v=122" alt="Auction" /></a>
      </div>
      <button class="scroll-btn next" aria-label="다음">▶</button>
      <div class="focus-line" aria-hidden="true"></div>
    </div>

    <!-- 고지/카피/카카오 문구(변수 사용) -->
    <div class="footer-notices">
      <p class="disclosure">${disclosure_text}</p>
      <p class="copyright">${copyright_text}</p>
      <p class="kakao">${kakao_notice_text}</p>
    </div>
  </footer>

  <!-- 스크립트: 최소한의 동작만(티스토리 호환 고려 / 외부의존 X) -->
  <script>
    (function(){
      var isPC2 = document.body.classList.contains('pc2');

      // 헤더: PC2 고정, PC1 비고정은 CSS로 처리

      // 공지 스크롤 시 마우스/터치 중지
      var nt = document.querySelector('.notice-ticker');
      if (nt) {
        let stop = false;
        nt.addEventListener('pointerdown', function(){ stop = true; });
        nt.addEventListener('pointerup', function(){ stop = false; });
      }

      // 카테고리 아코디언(2초 유지, 외부 클릭/미선택 시 자동 닫힘)
      document.querySelectorAll('.cat-head').forEach(function(btn){
        var timer;
        btn.addEventListener('click', function(){
          var item = btn.closest('.cat-item');
          var open = item.classList.toggle('open');
          clearTimeout(timer);
          if(open){
            timer = setTimeout(function(){ item.classList.remove('open'); }, 2000);
          }
        });
      });

      // 방문자 월간 색상(샘플)
      var m = document.getElementById('visit-monthly');
      if (m) {
        var val = parseInt(m.textContent,10)||0;
        var cls = 'v-navy';
        if (val > 100000) cls='v-orange';
        if (val > 500000) cls='v-red';
        m.classList.add(cls);
      }

      // 파트너 버튼 링크: 운영자 설정값 적용(키가 없으면 비활성)
      document.querySelectorAll('[data-key]').forEach(function(a){
        var key = a.getAttribute('data-key');
        // 실제에선 티스토리 변수/쿠키/스토리지에서 읽어와 적용
        var url = ''; // TODO: 운영자 입력값 주입
        if(url){ a.setAttribute('href', url); a.classList.add('active'); }
        else   { a.setAttribute('href', '#'); a.classList.add('inactive'); a.setAttribute('aria-disabled','true');}
      });

      // PC2 읽기 네비 : 스크롤 감지하여 호버상태처럼 1.5s 표시
      if (isPC2) {
        var navPrev = document.querySelector('.reading-nav .nav-prev');
        var navNext = document.querySelector('.reading-nav .nav-next');
        var hideTimer;
        var onScroll = function(){
          [navPrev, navNext].forEach(function(el){ el && el.classList.add('show'); });
          clearTimeout(hideTimer);
          hideTimer = setTimeout(function(){
            [navPrev, navNext].forEach(function(el){ el && el.classList.remove('show'); });
          }, 1500);
        };
        window.addEventListener('scroll', onScroll, {passive:true});
      }

      // 번역 오브(이동형 in-app 창)
      var orb = document.getElementById('translate-orb');
      if (orb) {
        let opened = false;
        orb.addEventListener('click', function(ev){
          opened = !opened;
          orb.classList.toggle('open', opened);
          // 댓글 옆 즉시 번역/재번역 UI는 실제 댓글 DOM에서 주입 (여기선 최소 마커)
        });
      }

      // Ads: 허가 시 자동 로드(비동기 자리표시자)
      document.querySelectorAll('.adsense-snippet').forEach(function(box){
        // 실제 애드센스 승인 후 스니펫 삽입 지점
        box.textContent = 'Google Ad (auto when approved)';
      });
    })();
  </script>
</body>
</html>
